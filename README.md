Make a generic sql query with auto-join for PostgreSQL towards foreign keys.

`pg-autojoin` is a Python library that simplifies complex SQL queries on a PostgreSQL database by automatically handling joins. Its primary function is to dynamically generate the necessary JOIN clauses based on foreign keys.
This allows you to retrieve data from a source table and all its related tables without manually writing intricate join statements.


# Key Features

1. Automated Join Generation: The library scans your database schema to identify foreign keys and then constructs the appropriate SQL JOIN statements. This is particularly useful for complex schemas where manually tracking all relationships would be tedious.

2. Dynamic Query Building: It lets you build generic queries to explore related data. This is great for data analysis, reporting, or building applications that need to dynamically display data from multiple interconnected tables.

3. Simple Interface: The process is straightforward:

    * Initialize the SqlJoin class with your PostgreSQL credentials.

    * Call get_joins() to see all related tables, or get_joined_query() to get the full SQL query with all the necessary joins.

4. Customization: You can set your own aliases for tables, which helps in creating more readable and manageable queries.


# Usage



```python

from pg_autojoin import SqlJoin

conn = SqlJoin(db="mydb", user="me", password="1234")
# host and port are optional, default to localhost

conn.get_joins(table="res_users")

# list all related tables with a dataframe output
shape: (4, 4)
┌───────────┬─────────────┬─────────────┬────────┐
│ table     ┆ foreign_key ┆ to_table    ┆ column │
│ ---       ┆ ---         ┆ ---         ┆ ---    │
│ str       ┆ str         ┆ str         ┆ str    │
╞═══════════╪═════════════╪═════════════╪════════╡
│ res_users ┆ company_id  ┆ res_company ┆ id     │
│ res_users ┆ partner_id  ┆ res_partner ┆ id     │
│ res_users ┆ create_uid  ┆ res_users   ┆ id     │
│ res_users ┆ write_uid   ┆ res_users   ┆ id     │
└───────────┴─────────────┴─────────────┴────────┘

Dataset comes from [Odoo business app](https://github.com/odoo/odoo), but you can use it with any PostgreSQL database.

```


```python

# define your own alias, but it's not a mandatory step
conn.set_alias(
    {"res_company": "c", "res_partner": "p", 'res_users': 'u'}
)

conn.get_joined_query(table="res_users")

```

give an auto-joined query output


```sql
SELECT u.* FROM res_users u 
  LEFT JOIN res_company c ON c.id = u.company_id 
  LEFT JOIN res_partner p ON p.id = u.partner_id 
  LEFT JOIN res_users u2 ON u2.id = u.create_uid 
  LEFT JOIN res_users u3 ON u3.id = u.write_uid
```


# Use case

You may dynamically want to produce dataframes with relevant data only based on a source table.

Have directly all joins might help a lot to specify the relevant data to get back.


# Installation

```bash
pip install git+https://github.com/bealdav/pg-autojoin.git@main
```

# Roadmap

- [ ] Add unit tests


# Final Notes

`pg-autojoin` is a powerful tool for developers and data scientists who need to quickly and efficiently query interconnected data in a PostgreSQL database without getting bogged down in writing complex join logic.

This description has been generated by AI which better than me for this kind of tasks.
